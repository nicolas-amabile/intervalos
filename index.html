<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŽµ Intervalos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #2a2c2f;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: white;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            max-width: 500px;
            width: 100%;
        }

        .title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .challenge-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: 15rem;
            align-content: center;
        }

        .challenge {
            font-size: clamp(1.5rem, 2rem, 3rem);
            font-weight: 600;
            margin-bottom: 1rem;
            min-height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .countdown {
            font-size: 4rem;
            font-weight: bold;
            color: #ffeb3b;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin: 1rem 0;
            min-height: 5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result {
            font-size: 4rem;
            font-weight: bold;
            color: #67bb6a;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin: 1rem 0;
            min-height: 4rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .retry-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
            padding: 1rem 2rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            width: 100%;
            opacity: 0;
        }

        .retry-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .retry-button:active {
            transform: translateY(0);
        }

        .hidden {
            opacity: 0;
            visibility: hidden;
            display: none;
        }

        .visible {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease;
            display: block;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="challenge-container">
            <div id="challenge" class="challenge"></div>
            <div id="countdown" class="countdown hidden"></div>
            <div id="result" class="result hidden"></div>
        </div>

        <button id="retryButton" class="retry-button" onclick="startNewChallenge()">Otro?</button>
    </div>

    <script>
        const NOTES = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];

        const INTERVALS = [
            // { name: 'Unisono', semitones: 0 },
            { name: 'II m', semitones: 1 },
            { name: 'II M', semitones: 2 },
            { name: 'III m', semitones: 3 },
            { name: 'III M', semitones: 4 },
            { name: 'IV Justa', semitones: 5 },
            { name: 'IV Aumentada', semitones: 6 },
            { name: 'V Justa', semitones: 7 },
            { name: 'VI m', semitones: 8 },
            { name: 'VI M', semitones: 9 },
            { name: 'VII m', semitones: 10 },
            { name: 'VII M', semitones: 11 },
            // { name: 'Octava', semitones: 12 }
        ];

        const DIRECTIONS = ['ASC', 'DSC'];

        let countdownInterval;

        // Helper function to get random element from array
        function getRandomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        // Calculate the target note based on starting note, interval, and direction
        function calculateTargetNote(startNote, interval, direction) {
            const startIndex = NOTES.indexOf(startNote);
            let targetIndex;

            if (direction === 'ASC') {
                targetIndex = (startIndex + interval.semitones) % 12;
            } else { // DSC
                targetIndex = (startIndex - interval.semitones + 12) % 12;
            }

            return NOTES[targetIndex];
        }

        // Generate a random challenge
        function generateChallenge() {
            const startNote = getRandomElement(NOTES);
            const interval = getRandomElement(INTERVALS);
            const direction = getRandomElement(DIRECTIONS);

            const targetNote = calculateTargetNote(startNote, interval, direction);

            return {
                challenge: `${interval.name} ${direction} de ${startNote}`,
                result: targetNote
            };
        }

        // Update UI elements visibility
        function showElement(elementId) {
            const element = document.getElementById(elementId);
            element.classList.remove('hidden');
            element.classList.add('visible');
        }

        function hideElement(elementId, keepSize = false) {
            const element = document.getElementById(elementId);
            element.classList.remove('visible');
            element.classList.add('hidden');
            if (keepSize) {
                element.style.display = 'block';
            }
        }

        // Start countdown
        function startCountdown(callback) {
            let count = 5;
            const countdownElement = document.getElementById('countdown');

            showElement('countdown');
            countdownElement.textContent = count;

            countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownElement.textContent = count;
                } else {
                    clearInterval(countdownInterval);
                    hideElement('countdown');
                    callback();
                }
            }, 1000);
        }

        // Show result
        function showResult(result) {
            const resultElement = document.getElementById('result');
            resultElement.textContent = result;
            showElement('result');
            showElement('retryButton');
        }

        // Start new challenge
        function startNewChallenge() {
            // Clear any existing countdown
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }

            // Hide result
            hideElement('result');
            hideElement('countdown');
            hideElement('retryButton', true);

            // Generate new challenge
            const { challenge, result } = generateChallenge();

            // Show challenge
            const challengeElement = document.getElementById('challenge');
            challengeElement.textContent = challenge;

            // Start countdown
            startCountdown(() => {
                showResult(result);
            });
        }

        // Initialize the app
        window.onload = function () {
            startNewChallenge();
        };
    </script>
</body>

</html>